<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Benchmarks • morphology</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Benchmarks">
<meta property="og:description" content="morphology">
<meta property="og:image" content="https://rogiersbart.github.io/morphology/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphology</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/morphology.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/background.html">Background</a>
    </li>
    <li>
      <a href="../articles/benchmarks.html">Benchmarks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Benchmarks</h1>
            
      
      
      <div class="hidden name"><code>benchmarks.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="analytical-morphological-quantities">Analytical morphological quantities<a class="anchor" aria-label="anchor" href="#analytical-morphological-quantities"></a>
</h2>
<p>Certain morphological quantities can be derived analytically for
particular systems. We consider here those that are evaluated by <span class="citation">Pant (2016)</span>, for fully penetrable spheres. First
we use the fully penetrable spheres generator provided by the package,
and we additionally load and attach the {ggplot2} and {tibble} packages,
to use them later to add the analytical solutions to our plots:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">morphology</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #FF5555;">!</span> Package {<span style="color: #BBBB00;">morphology</span>} is still in its experimental lifecycle stage.</span></span>
<span><span class="co">#&gt; <span style="color: #FF5555;">!</span> Use at your own risk, and submit issues here:</span></span>
<span><span class="co">#&gt; <span style="color: #FF5555;">!</span> &lt;<span style="color: #00BBBB;">https://github.com/rogiersbart/morphology/issues</span>&gt;</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">spheres</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_fully_penetrable_spheres.html">gen_fully_penetrable_spheres</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This generates a 200^3 voxel 3D array by default, with a sphere
radius of 15, exactly like the one used by <span class="citation">Pant
(2016)</span>. The result looks as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">spheres</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/as.raster.html" class="external-link">as.raster</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>interpolate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="section level3">
<h3 id="two-point-correlation-function">Two-point correlation function<a class="anchor" aria-label="anchor" href="#two-point-correlation-function"></a>
</h3>
<p>The two-point correlation function can be obtained by scaling the
mean number of neighbours by the inverse neighbourhood and the
proportion. Hence, instead of providing the mean number of neighbours
for a given distance bin, it provides the probability that voxels with a
given separation distance both belong to the category of interest (here
the matrix phase). If we do this for a subset (1/25) of all x direction
1D subarrays, we can get rather close to the analytical result derived
first by <span class="citation">Weissberg (1963)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v2r</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">r</span> <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="va">r</span> <span class="op">&lt;=</span> <span class="fl">2</span>, <span class="fl">4</span><span class="op">/</span><span class="fl">3</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">*</span><span class="va">x</span><span class="op">/</span><span class="va">r</span><span class="op">-</span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="va">r</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">/</span><span class="fl">16</span><span class="op">)</span>, <span class="fl">8</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">spheres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_at.html">look_at</a></span><span class="op">(</span><span class="st">"voxels"</span>, of_category <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/look_in.html">look_in</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"x"</span>, every <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_for.html">look_for</a></span><span class="op">(</span>neighbours <span class="op">=</span> <span class="fl">81</span>, within <span class="op">=</span> <span class="fl">40</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/describe.html">describe</a></span><span class="op">(</span><span class="va">mean</span>, name <span class="op">=</span> <span class="st">"{morphology}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/scale_by.html">scale_by</a></span><span class="op">(</span><span class="st">"inverse neighbourhood"</span>, <span class="st">"proportion"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/visualise.html">visualise</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"distance"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, colour <span class="op">=</span> <span class="st">"analytical"</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">40</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">392</span><span class="op">/</span><span class="fl">200</span><span class="op">^</span><span class="fl">3</span><span class="op">*</span><span class="fl">15</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="fu">v2r</span><span class="op">(</span><span class="va">x</span>, r <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="cluster-function">Cluster function<a class="anchor" aria-label="anchor" href="#cluster-function"></a>
</h3>
<p>The cluster function has as additional requirement that the two
voxels are connected in 3D. Hence, if we repeat the above, but look at
<code>"components"</code> instead of <code>"voxels"</code>, and ask for
describing only the connected cases, we end up with the cluster
function. Unfortunately there is no analytical solution for this, but
since fully penetrable spheres with the currently considered volume
fraction result in a fully connected matrix phase, the cluster function
should be the same as the two-point correlation function, which is
checked here:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spheres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_at.html">look_at</a></span><span class="op">(</span><span class="st">"components"</span>, of_category <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/look_in.html">look_in</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"x"</span>, every <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_for.html">look_for</a></span><span class="op">(</span>neighbours <span class="op">=</span> <span class="fl">81</span>, within <span class="op">=</span> <span class="fl">40</span>, from_border <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/describe.html">describe</a></span><span class="op">(</span><span class="va">mean</span>, connected <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"{morphology}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/scale_by.html">scale_by</a></span><span class="op">(</span><span class="st">"inverse neighbourhood"</span>, <span class="st">"proportion"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/visualise.html">visualise</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"distance"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, colour <span class="op">=</span> <span class="st">"analytical"</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">40</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">392</span><span class="op">/</span><span class="fl">200</span><span class="op">^</span><span class="fl">3</span><span class="op">*</span><span class="fl">15</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="fu">v2r</span><span class="op">(</span><span class="va">x</span>, r <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="lineal-path-function">Lineal path function<a class="anchor" aria-label="anchor" href="#lineal-path-function"></a>
</h3>
<p>For the lineal path function, we just have to modify the kernel width
of the kernel to determine connectivity, so that we look at 1D
connectivity in the direction of interest. For this, an analytical
solution is available from <span class="citation">Lu and Torquato
(1992)</span>, and we can reproduce it rather well:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spheres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_at.html">look_at</a></span><span class="op">(</span><span class="st">"components"</span>, of_category <span class="op">=</span> <span class="fl">0</span>, kernel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/look_in.html">look_in</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"x"</span>, every <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_for.html">look_for</a></span><span class="op">(</span>neighbours <span class="op">=</span> <span class="fl">81</span>, within <span class="op">=</span> <span class="fl">40</span>, from_border <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/describe.html">describe</a></span><span class="op">(</span><span class="va">mean</span>, connected <span class="op">=</span> <span class="cn">TRUE</span>, name <span class="op">=</span> <span class="st">"{morphology}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/scale_by.html">scale_by</a></span><span class="op">(</span><span class="st">"inverse neighbourhood"</span>, <span class="st">"proportion"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/visualise.html">visualise</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"distance"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, colour <span class="op">=</span> <span class="st">"analytical"</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">40</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">spheres</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="va">x</span> <span class="op">/</span> <span class="fl">4</span> <span class="op">/</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="chord-length-distribution">Chord length distribution<a class="anchor" aria-label="anchor" href="#chord-length-distribution"></a>
</h3>
<p>Related to the lineal path function is the chord length distribution,
where we do not look at the probability of two voxels to be connected
through a lineal path, but rather at the distribution of (maximum)
lengths of all lineal paths. This can be done by tabulating (here with
base R <code><a href="https://rdrr.io/r/base/table.html" class="external-link">table()</a></code>) the occurrences of component IDs in the
output from <code><a href="../reference/look_at.html">look_at()</a></code> directly, while keeping the kernel
width the same for looking at 1D connectivity. Comparing with the
analytical expression by <span class="citation">Torquato and Lu
(1993)</span> gives us:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spheres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_at.html">look_at</a></span><span class="op">(</span><span class="st">"components"</span>, of_category <span class="op">=</span> <span class="fl">0</span>, kernel_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="va">_</span><span class="op">[[</span><span class="st">"component"</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span>cut <span class="op">=</span> <span class="fl">0</span>, n <span class="op">=</span> <span class="fl">50</span>, bw <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="va">_</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"{morphology}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/visualise.html">visualise</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"chord length"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, colour <span class="op">=</span> <span class="st">"analytical"</span><span class="op">)</span>, data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">200</span>,</span>
<span>    y <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">/</span><span class="fl">15</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">spheres</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">spheres</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">x</span><span class="op">/</span><span class="fl">4</span><span class="op">/</span><span class="fl">15</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"analytical"</span>  </span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-with-spatstat-explore">Comparison with {spatstat.explore}<a class="anchor" aria-label="anchor" href="#comparison-with-spatstat-explore"></a>
</h2>
<div class="section level3">
<h3 id="reduced-second-moment-k-function">Reduced second moment / K function<a class="anchor" aria-label="anchor" href="#reduced-second-moment-k-function"></a>
</h3>
<p>If we reduce the size of the dataset, using <code>every</code>, then
we can more easily (at least on my machine) compare against the
implementation provided by <code><a href="https://rdrr.io/pkg/spatstat.explore/man/K3est.html" class="external-link">spatstat.explore::K3est()</a></code> :</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">every</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">10</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">spheres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_at.html">look_at</a></span><span class="op">(</span><span class="st">"voxels"</span>, of_category <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/look_in.html">look_in</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"xyz"</span>, every <span class="op">=</span> <span class="va">every</span><span class="op">)</span></span>
<span><span class="va">rsm_m</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_for.html">look_for</a></span><span class="op">(</span>neighbours <span class="op">=</span> <span class="fl">100</span>, within <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/describe.html">describe</a></span><span class="op">(</span><span class="va">mean</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/scale_by.html">scale_by</a></span><span class="op">(</span><span class="st">"inverse proportion"</span>, <span class="st">"inverse every"</span><span class="op">)</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">spatstat.geom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/pp3.html" class="external-link">pp3</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">df</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">df</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">200</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rsm_s</span> <span class="op">&lt;-</span> <span class="fu">spatstat.explore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/K3est.html" class="external-link">K3est</a></span><span class="op">(</span><span class="va">pp</span>, rmax <span class="op">=</span> <span class="fl">20</span>, nrval <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">rsm_s</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="va">_</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"{spatstat.explore}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">rsm_m</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"{morphology}"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/visualise.html">visualise</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"distance"</span>, y <span class="op">=</span> <span class="st">"reduced second moment"</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="pair-correlation-function">Pair correlation function<a class="anchor" aria-label="anchor" href="#pair-correlation-function"></a>
</h3>
<p>It is a bit harder to get a decent match with the results of the
implementation provided by <code><a href="https://rdrr.io/pkg/spatstat.explore/man/pcf3est.html" class="external-link">spatstat.explore::pcf3est()</a></code>, as
it is using kernel smoothing, but with adjustments of the default
distance in morphology, and playing with the kernel width adjustment
factor, we can get pretty close:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">every</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">5</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">spheres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_at.html">look_at</a></span><span class="op">(</span><span class="st">"voxels"</span>, of_category <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/look_in.html">look_in</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"xyz"</span>, every <span class="op">=</span> <span class="va">every</span><span class="op">)</span></span>
<span><span class="va">pcf_m</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_for.html">look_for</a></span><span class="op">(</span>neighbours <span class="op">=</span> <span class="fl">300</span>, within <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/describe.html">describe</a></span><span class="op">(</span><span class="va">mean</span>, at <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">21</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/scale_by.html">scale_by</a></span><span class="op">(</span><span class="st">"inverse neighbourhood"</span>, <span class="st">"inverse proportion"</span>, <span class="st">"inverse every"</span><span class="op">)</span> </span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">spatstat.geom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/pp3.html" class="external-link">pp3</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">df</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">df</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">200</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pcf_s</span> <span class="op">&lt;-</span> <span class="fu">spatstat.explore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/pcf3est.html" class="external-link">pcf3est</a></span><span class="op">(</span><span class="va">pp</span>, rmax <span class="op">=</span> <span class="fl">20</span>, nrval <span class="op">=</span> <span class="fl">21</span>, adjust <span class="op">=</span> <span class="fl">0.4</span>, correction <span class="op">=</span> <span class="st">"isotropic"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">pcf_s</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="va">_</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"{spatstat.explore}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">pcf_m</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"{morphology}"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/visualise.html">visualise</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"distance"</span>, y <span class="op">=</span> <span class="st">"pair correlation function"</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="empty-space-function">Empty space function<a class="anchor" aria-label="anchor" href="#empty-space-function"></a>
</h3>
<p>As we work here with a regular grid of points instead of a point
pattern, the voxels of our category of interest are matched with
themselves, which results in an offset at distance zero, equal to the
proportion of that category (around 0.5 here), for the empty space
function. Typically, however, it starts at a cumulative probability of
zero. The implementation provided by
<code><a href="https://rdrr.io/pkg/spatstat.explore/man/F3est.html" class="external-link">spatstat.explore::F3est()</a></code> does allow for a discrete
approximation, however, and when we set the voxel side length to one for
comparing against our implementation, we can reproduce the {morphology}
behaviour:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">spheres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_at.html">look_at</a></span><span class="op">(</span><span class="st">"voxels"</span>, of_category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, in_relation_to <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/look_in.html">look_in</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"xyz"</span><span class="op">)</span></span>
<span><span class="va">esf_m</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_for.html">look_for</a></span><span class="op">(</span>neighbours <span class="op">=</span> <span class="fl">1</span>, within <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/describe.html">describe</a></span><span class="op">(</span><span class="va">mean</span>, cumulative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu">spatstat.geom</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.geom/man/pp3.html" class="external-link">pp3</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">df</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">df</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">200</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">esf_s</span> <span class="op">&lt;-</span> <span class="fu">spatstat.explore</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/spatstat.explore/man/F3est.html" class="external-link">F3est</a></span><span class="op">(</span><span class="va">pp</span>, rmax <span class="op">=</span> <span class="fl">20</span>, nrval <span class="op">=</span> <span class="fl">21</span>, vside <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">esf_s</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="va">_</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"{spatstat.explore}"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">esf_m</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"{morphology}"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/visualise.html">visualise</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"distance"</span>, y <span class="op">=</span> <span class="st">"cumulative probability"</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-with-gstat">Comparison with {gstat}<a class="anchor" aria-label="anchor" href="#comparison-with-gstat"></a>
</h2>
<div class="section level3">
<h3 id="variogram">Variogram<a class="anchor" aria-label="anchor" href="#variogram"></a>
</h3>
<p>For the (indicator) variogram, the quickest solution is to look into
cross-category pairs here. Every distance bin becomes a Bernouilli
variable, where the squared difference is 1 in case of different
categories, and 0 when they are the same. The probability of a
difference of 1 is equal to double the probability of 0-1 pairs (as this
is the same as that for 1-0 pairs), and the probability of a difference
of 0 is then the complement of that. With a final division by two to get
to the semivariance, we get:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">spheres</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gstat/man/gstat.html" class="external-link">gstat</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"phase"</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">value</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  locations <span class="op">=</span> <span class="op">~</span> <span class="va">Var1</span> <span class="op">+</span> <span class="va">Var2</span> <span class="op">+</span> <span class="va">Var3</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vgm_g</span> <span class="op">&lt;-</span> <span class="fu">gstat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gstat/man/variogram.html" class="external-link">variogram</a></span><span class="op">(</span><span class="va">g</span>, cutoff <span class="op">=</span> <span class="fl">20</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dist</span>, y <span class="op">=</span> <span class="va">gamma</span>, name <span class="op">=</span> <span class="st">"{gstat}"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="va">_</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"name"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">vgm_m</span> <span class="op">&lt;-</span> <span class="va">spheres</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/look_at.html">look_at</a></span><span class="op">(</span><span class="st">"voxels"</span>, of_category <span class="op">=</span> <span class="fl">0</span>, in_relation_to <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/look_in.html">look_in</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/look_for.html">look_for</a></span><span class="op">(</span>neighbours <span class="op">=</span> <span class="fl">41</span>, within <span class="op">=</span> <span class="fl">20</span>, from_border <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/describe.html">describe</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/scale_by.html">scale_by</a></span><span class="op">(</span><span class="st">"inverse neighbourhood"</span>, <span class="st">"proportion"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"{morphology}"</span><span class="op">)</span></span>
<span><span class="va">vgm_m</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">vgm_m</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">vgm_m</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/visualise.html">visualise</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">vgm_m</span>, <span class="va">vgm_g</span><span class="op">)</span>, x <span class="op">=</span> <span class="st">"distance"</span>, y <span class="op">=</span> <span class="st">"semivariance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmarks_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-lu1992a" class="csl-entry">
Lu, Binglin, and S. Torquato. 1992. <span>“Lineal-Path Function for
Random Heterogeneous Materials.”</span> <em>Physical Review A</em> 45
(2): 922–29. <a href="https://doi.org/10.1103/PhysRevA.45.922" class="external-link">https://doi.org/10.1103/PhysRevA.45.922</a>.
</div>
<div id="ref-pant2016" class="csl-entry">
Pant, Lalit Mohan. 2016. <span>“Stochastic Characterization and
Reconstruction of Porous Media.”</span> PhD thesis.
</div>
<div id="ref-torquato1993" class="csl-entry">
Torquato, S., and B. Lu. 1993. <span>“Chord-Length Distribution Function
for Two-Phase Random Media.”</span> <em>Physical Review E</em> 47 (4):
2950–53. <a href="https://doi.org/10.1103/PhysRevE.47.2950" class="external-link">https://doi.org/10.1103/PhysRevE.47.2950</a>.
</div>
<div id="ref-weissberg1963" class="csl-entry">
Weissberg, Harold L. 1963. <span>“Effective Diffusion Coefficient in
Porous Media.”</span> <em>Journal of Applied Physics</em> 34 (9):
2636–39. <a href="https://doi.org/10.1063/1.1729783" class="external-link">https://doi.org/10.1063/1.1729783</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://rogiersbart.github.io" class="external-link">Bart Rogiers</a>, <a href="https://www.sckcen.be" class="external-link">SCK CEN</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
